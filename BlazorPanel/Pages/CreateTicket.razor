@page "/create-ticket"
@inject TicketService TicketService
@inject NavigationManager Navigation
@using TicketSystem.Blazor.Models

<PageTitle>Crear Nuevo Ticket</PageTitle>

<div class="mb-4">
    <button class="btn btn-secondary" @onclick="Volver">← Volver al listado</button>
</div>

<h3>Nuevo Ticket</h3>

<div class="card-elegant" style="max-width: 800px;">
    <div class="card-body">
        <div class="mb-3">
            <label class="d-block mb-1 font-weight-bold text-muted small">CLIENTE</label>
            <input type="text" class="form-control" @bind="ticket.ClienteNombre" placeholder="Nombre del cliente" />
        </div>

        <div class="mb-3">
            <label class="d-block mb-1 font-weight-bold text-muted small">TÍTULO</label>
            <input type="text" class="form-control" @bind="ticket.Titulo" placeholder="Resumen del problema" />
        </div>

        <div class="mb-3">
            <label class="d-block mb-1 font-weight-bold text-muted small">DESCRIPCIÓN</label>
            <textarea class="form-control" rows="4" @bind="ticket.Descripcion" placeholder="Detalle completo"></textarea>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label class="d-block mb-1 font-weight-bold text-muted small">PRIORIDAD</label>
                <select class="form-control" @bind="ticket.Prioridad">
                    <option value="Baja">Baja</option>
                    <option value="Media">Media</option>
                    <option value="Alta">Alta</option>
                </select>
            </div>
            <div class="col-md-6 mb-3">
                <label class="d-block mb-1 font-weight-bold text-muted small">ESTADO INICIAL</label>
                <input type="text" class="form-control" value="Abierto" readonly style="background-color: #f1f5f9;" />
            </div>
        </div>

        <div class="d-flex gap-2 mt-4">
             <button class="btn btn-primary" @onclick="CrearTicket">Crear Ticket</button>
             <button class="btn btn-secondary" @onclick="Volver">Cancelar</button>
        </div>
    </div>
</div>

@code {
    private Ticket ticket = new Ticket { Estado = "Abierto", Prioridad = "Media" };

    private async Task CrearTicket()
    {
        await TicketService.CreateTicketAsync(ticket);
        Navigation.NavigateTo("/");
    }

    private void Volver()
    {
        Navigation.NavigateTo("/");
    }
}
